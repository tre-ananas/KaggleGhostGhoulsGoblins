library(vroom)
library(tidyverse)
library(tidymodels)
# Load Data
ggg_train_na <- vroom("trainWithmissingValues.csv")
ggg_train <- vroom("train.csv")
ggg_test <- vroom("test.csv")
str(ggg_train_na)
View(ggg_train_na)
library(DataExplorer)
# EDA
ggg_train_na %>%
inspect_cat()
library(inspectdf)
# EDA
ggg_train_na %>%
inspect_cat()
# EDA for NAs
sum(is.na(ggg_train_na$bone_length))
sum(is.na(ggg_train_na$rotting_flesh))
sum(is.na(ggg_train_na$hair_length))
sum(is.na(ggg_train_na$has_soul))
sum(is.na(ggg_train_na$color))
sum(is.na(ggg_train_na$type))
na_count <-sapply(x, function(y) sum(length(which(is.na(y)))))
na_count <-sapply(ggg_train_na, function(y) sum(length(which(is.na(y)))))
data.frame(na_count)
# Impute Missing Values
# Create Recipe
imp_rec <- recipe(ACTION ~ ., data = employee_train) %>%
step_impute_knn(var = hair_length,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(var = rotting_flesh,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(var = bone_length,
impute_with = all_predictors(),
neighbors = 5)
# Impute Missing Values
# Create Recipe
imp_rec <- recipe(ACTION ~ ., data = ggg_train_na) %>%
step_impute_knn(var = hair_length,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(var = rotting_flesh,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(var = bone_length,
impute_with = all_predictors(),
neighbors = 5)
# Impute Missing Values
# Create Recipe
imp_rec <- recipe(ACTION ~ ., data = ggg_train_na) %>%
step_impute_knn(var = hair_length,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(var = rotting_flesh,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(var = bone_length,
impute_with = all_predictors(),
neighbors = 5)
# Load Libraries
library(vroom)
library(tidyverse)
library(tidymodels)
library(embed)
# Impute Missing Values
# Create Recipe
imp_rec <- recipe(ACTION ~ ., data = ggg_train_na) %>%
step_impute_knn(var = hair_length,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(var = rotting_flesh,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(var = bone_length,
impute_with = all_predictors(),
neighbors = 5)
# Impute Missing Values
# Create Recipe
imp_rec <- recipe(ACTION ~ ., data = ggg_train_na) %>%
step_impute_knn(var = hair_length,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(var = rotting_flesh,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(var = bone_length,
impute_with = all_predictors(),
neighbors = 5)
# Impute Missing Values
# Create Recipe
imp_rec <- recipe(type ~ ., data = ggg_train_na) %>%
step_impute_knn(var = hair_length,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(var = rotting_flesh,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(var = bone_length,
impute_with = all_predictors(),
neighbors = 5)
# Prep, Bake, and View Recipe
imp_prep <- prep(imp_rec)
# Impute Missing Values
# Create Recipe
imp_rec <- recipe(type ~ ., data = ggg_train_na) %>%
step_impute_knn(var = hair_length,
impute_with = c('bone_length',
'rotting_flesh',
'has_soul',
'color'),
neighbors = 5) %>%
step_impute_knn(var = rotting_flesh,
impute_with = c('bone_length',
'hair_length',
'has_soul',
'color'),
neighbors = 5) %>%
step_impute_knn(var = bone_length,
impute_with = c('hair_length',
'rotting_flesh',
'has_soul',
'color'),
neighbors = 5)
# Prep, Bake, and View Recipe
imp_prep <- prep(imp_rec)
# Impute Missing Values
# Create Recipe
imp_rec <- recipe(type ~ ., data = ggg_train_na) %>%
step_impute_knn(hair_length,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(rotting_flesh,
impute_with = all_predictors(),
neighbors = 5) %>%
step_impute_knn(bone_length,
impute_with = all_predictors(),
neighbors = 5)
# Prep, Bake, and View Recipe
imp_prep <- prep(imp_rec)
data.frame(na_count)
# Impute Missing Values
# Create Recipe
imp_rec <- recipe(ACTION ~ ., data = ggg_train_na) %>%
step_impute_knn(var = hair_length,
impute_with = c('has_soul',
'color'),
neighbors = 5) %>%
step_impute_knn(var = rotting_flesh,
impute_with = c('has_soul',
'color',
'hair_length'),
neighbors = 5) %>%
step_impute_knn(var = bone_length,
impute_with = c('has_soul',
'color',
'rotting_flesh',
'hair_length'),
neighbors = 5)
# Impute Missing Values
# Create Recipe
imp_rec <- recipe(type ~ ., data = ggg_train_na) %>%
step_impute_knn(var = hair_length,
impute_with = c('has_soul',
'color'),
neighbors = 5) %>%
step_impute_knn(var = rotting_flesh,
impute_with = c('has_soul',
'color',
'hair_length'),
neighbors = 5) %>%
step_impute_knn(var = bone_length,
impute_with = c('has_soul',
'color',
'rotting_flesh',
'hair_length'),
neighbors = 5)
# Prep, Bake, and View Recipe
imp_prep <- prep(imp_rec)
# Impute Missing Values
# Create Recipe
imp_rec <- recipe(type ~ ., data = ggg_train_na) %>%
step_impute_knn(var = hair_length,
impute_with = c('has_soul',
'color'),
neighbors = 5) %>%
step_impute_knn(var = rotting_flesh,
impute_with = c('has_soul',
'color'),
neighbors = 5) %>%
step_impute_knn(var = bone_length,
impute_with = c('has_soul',
'color'),
neighbors = 5)
# Prep, Bake, and View Recipe
imp_prep <- prep(imp_rec)
rlang::last_trace()
data.frame(na_count)
hist(ggg_train_na$hair_length)
hist(ggg_train_na$rotting_flesh)
hist(ggg_train_na$bone_length)
# Impute Missing Values
# Create Recipe
imp_rec <- recipe(type ~ ., data = ggg_train_na) %>%
step_impute_mean(hair_length) %>%
step_impute_mean(rotting_flesh) %>%
step_impute_mean(bone_length)
# Prep, Bake, and View Recipe
imp_prep <- prep(imp_rec)
bake(imp_prep, ggg_train_na) %>%
slice(1:10)
baked_train_na <- bake(imp_prep, ggg_train_na)
baked_train_na
# Caluclate RMSE
rmse_vec(baked_train_na[is.na(ggg_train_na)], imputedSet[is.na(ggg_train_na)])
imp_train <- bake(imp_prep, ggg_train_na)
# Caluclate RMSE
rmse_vec(ggg_train[is.na(ggg_train_na)], imp_train[is.na(ggg_train_na)])
